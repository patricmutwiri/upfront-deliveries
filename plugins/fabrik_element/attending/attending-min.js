/*! Fabrik */

define(["jquery","fab/element"],function(a,b){return window.FbAttending=new Class({Extends:b,initialize:function(b,c){this.parent(b,c),this.watchJoin(),this.spinner=new Asset.image(Fabrik.liveSite+"media/com_fabrik/images/ajax-loader.gif",{alt:"loading",class:"ajax-loader"}),this.message=a(this.element).find(".msg")},watchJoin:function(){var b=this,c=a(this.getContainer()),d=c.find('*[data-action="add"]');d.off("click",function(a){b.join(a)}),d.on("click",function(a){b.join(a)})},join:function(){this.save("join")},leave:function(){this.save("leave")},save:function(b){this.spinner.inject(this.message);var c=this,d={option:"com_fabrik",format:"raw",task:"plugin.pluginAjax",plugin:"attending",method:b,g:"element",element_id:this.options.elid,formid:this.options.formid,row_id:this.options.row_id,elementname:this.options.elid,userid:this.options.userid,rating:this.rating,listid:this.options.listid};a.ajax({url:"",data:d}).done(function(){c.spinner.remove()})}}),window.FbAttending});